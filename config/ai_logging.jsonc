// AI Logging Configuration
{
  "ai_logging": {
    "enabled": true,
    "log_file": "state/ai_calls.log"
  },
  "gemini_verification": {
    "pre_call_checklist": [
      {
        "name": "cli_installed",
        "check": "which gemini",
        "description": "Verify Gemini CLI installation"
      },
      {
        "name": "wrapper_exists",
        "check": "test -f scripts/gemini-wrapper.sh",
        "description": "Verify wrapper script exists"
      },
      {
        "name": "prompt_file_ready",
        "check": "test -f ${PROMPT_FILE}",
        "description": "Verify prompt file is ready"
      }
    ],
    "post_call_checklist": [
      {
        "name": "tmux_session_active",
        "check": "tmux has-session -t ax-gemini 2>/dev/null",
        "description": "Verify tmux session is active"
      },
      {
        "name": "output_saved",
        "check": "test -f outputs/${OUTPUT_FILE}",
        "description": "Verify output file is saved"
      }
    ]
  },
  "codex_verification": {
    "pre_call_checklist": [
      {
        "name": "cli_installed",
        "check": "which codex",
        "description": "Verify Codex CLI installation"
      },
      {
        "name": "wrapper_exists",
        "check": "test -f scripts/codex-wrapper.sh",
        "description": "Verify wrapper script exists"
      },
      {
        "name": "sandbox_ready",
        "check": "docker ps | grep -q codex-sandbox || true",
        "description": "Verify sandbox is ready (optional)"
      }
    ],
    "post_call_checklist": [
      {
        "name": "tmux_session_active",
        "check": "tmux has-session -t ax-codex 2>/dev/null",
        "description": "Verify tmux session is active"
      },
      {
        "name": "output_saved",
        "check": "test -f outputs/${OUTPUT_FILE}",
        "description": "Verify output file is saved"
      }
    ]
  },
  "handoff_ai_log": {
    "enabled": true,
    "format": "## AI Call Log\n\n| AI | Call Time | Prompt File | Result File | Status |\n|----|-----------|-------------|-------------|--------|\n{{#each ai_calls}}\n| {{model}} | {{timestamp}} | {{prompt_file}} | {{output_file}} | {{status}} |\n{{/each}}\n",
    "include": [
      "model",
      "timestamp",
      "prompt_file",
      "output_file",
      "status",
      "duration_seconds"
    ]
  },
  "stage_tracking": {
    "enabled": true,
    "track": [
      "stage_id",
      "ai_model",
      "call_count",
      "total_duration",
      "success_rate"
    ]
  },
  "log_format": {
    "single_call": "[{{timestamp}}] {{stage_id}} - {{model}}\nPrompt: {{prompt_file}}\nOutput: {{output_file}}\nStatus: {{status}}\nDuration: {{duration}}s\n",
    "daily_summary": "=== AI Call Daily Summary ({{date}}) ===\nTotal Calls: {{total_calls}}\nGemini: {{gemini_calls}}\nCodex: {{codex_calls}}\nClaudeCode: {{claude_calls}}\nSuccess Rate: {{success_rate}}%\n"
  },
  "alerts": {
    "consecutive_failures": {
      "threshold": 3,
      "action": "notify_user",
      "message": "AI calls have failed {{count}} times consecutively. Please check settings."
    },
    "slow_response": {
      "threshold_seconds": 300,
      "action": "warn",
      "message": "AI response exceeded {{threshold}} seconds."
    }
  }
}