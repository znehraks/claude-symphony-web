# Work State Save - {{TIMESTAMP}}

## Context State
- **Remaining Context**: {{REMAINING_PERCENT}}%
- **Save Trigger**: {{TRIGGER_REASON}}

---

## Current Stage
**{{STAGE_ID}}**: {{STAGE_NAME}}

## Stage Progress
- Total Tasks: {{TOTAL_TASKS}}
- Completed: {{COMPLETED_TASKS}}
- Progress: {{PROGRESS_PERCENT}}%

---

## Completed Tasks
{{#each COMPLETED_ITEMS}}
- [x] {{this.name}} ({{this.completed_at}})
{{/each}}

## Tasks In Progress
{{#each IN_PROGRESS_ITEMS}}
- [ ] **{{this.name}}**
  - Started: {{this.started_at}}
  - Status: {{this.status_detail}}
{{/each}}

## Pending Tasks
{{#each PENDING_ITEMS}}
- [ ] {{this.name}}
{{/each}}

---

## Key Context

### Key Decisions
{{#each KEY_DECISIONS}}
- **{{this.topic}}**: {{this.decision}}
  - Rationale: {{this.rationale}}
{{/each}}

### Modified Files
{{#each MODIFIED_FILES}}
- `{{this.path}}` - {{this.change_type}} ({{this.lines_changed}} lines)
{{/each}}

### Active Issues/Bugs
{{#each ACTIVE_ISSUES}}
- {{this.description}}
  - Status: {{this.status}}
{{/each}}

---

## AI Call Log
| AI | Time | Prompt File | Result File |
|----|------|-------------|-------------|
{{#each AI_CALLS}}
| {{this.model}} | {{this.timestamp}} | {{this.prompt_file}} | {{this.output_file}} |
{{/each}}

---

## Recovery Instructions

### Immediate Actions (On Session Recovery)
1. Read this file: `state/context/{{FILENAME}}`
2. Reference current HANDOFF: `{{HANDOFF_FILE}}`
3. Resume from next task: **{{NEXT_TASK}}**

### Context Restoration Priority
1. Load current stage `CLAUDE.md`
2. Reference previous stage `HANDOFF.md`
3. Check active task status
4. Open files being modified

### Additional Reference Files
{{#each REFERENCE_FILES}}
- `{{this}}`
{{/each}}

---

## Metadata
```json
{
  "created_at": "{{TIMESTAMP}}",
  "stage_id": "{{STAGE_ID}}",
  "remaining_context_percent": {{REMAINING_PERCENT}},
  "trigger": "{{TRIGGER_REASON}}",
  "recovery_priority": "{{RECOVERY_PRIORITY}}"
}
```
